:root {
  --font-base: 'Roboto', sans-serif; /* Fuente moderna y legible */
  --font-cinzel: 'Cinzel', serif;
  --font-weight-regular: 400;
  --font-weight-medium: 500;
  --font-weight-bold: 600;

  /* Paleta pastel invierno/bosque */
  --bg-gradient-start: #E3F2FD; /* azul muy claro */
  --bg-gradient-end:   #F1F8E9; /* verde pálido */
  --card-bg:           rgba(255, 255, 255, 0.75); /* blanco semitransparente */
  --text-primary:      #2E3A46; /* gris azulado oscuro */
  --text-secondary:    #4F5B66; /* gris medio */
  --accent:            #81C784; /* verde pastel */
  --accent-hover:      #66BB6A; /* verde pastel un poco más oscuro para hover */
  --button-bg:         #FFFFFF; /* blanco puro */
  --button-border:     #B0BEC5; /* gris claro */
  --button-hover:      #CFD8DC; /* gris perla */
  --button-text:       var(--text-primary); /* Variable explícita para el color del texto del botón por defecto */
  --button-secondary-hover-border: #90A4AE; /* Borde un poco más oscuro para secondary hover */


  /* Colores para mensajes */
  --success-bg: #E8F5E9;
  --success-text: #2E7D32;
  --error-bg: #FFEBEE;
  --error-text: #C62828;

  --main-padding: 1rem; /* Variable para el padding del main-container */
}

/* Clase para ocultar elementos */
.hidden {
  display: none !important;
}

/* 3) Reset mínimo y base */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

.btn {
  font-family: var(--font-base);
  font-size: 1rem;
  font-weight: var(--font-weight-medium); /* Reduje un poco el peso para más legibilidad */
  background: var(--button-bg);
  border: 1px solid var(--button-border);
  border-radius: 6px; /* Bordes un poco menos redondeados para un estilo más moderno */
  padding: 0.7rem 1.4rem; /* Ajuste del padding para que coincida con el nuevo border-radius */
  color: var(--button-text); /* Usar la variable de color de texto */
  cursor: pointer;
  /* Mejorar la transición para incluir transformaciones y sombras */
  transition: background 0.2s ease-in-out,
              border-color 0.2s ease-in-out,
              color 0.2s ease-in-out,
              transform 0.2s ease-in-out,
              box-shadow 0.2s ease-in-out;
  margin: 0.5rem 0.25rem;
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  text-decoration: none;
  /* Añadir una sombra sutil por defecto */
  box-shadow: 0 1px 3px rgba(0,0,0,0.08); /* Sombra más sutil */
  outline: none; /* Eliminar el outline por defecto */
}

.btn:hover {
  background: #E0E0E0; /* Gris más claro para el hover */
  border-color: var(--button-border); /* Mantener o cambiar sutilmente el borde en hover */
  color: var(--text-primary); /* Mantener el color del texto */
  transform: translateY(-1px); /* Menos elevación */
  /* Añadir una sombra más pronunciada en hover */
  box-shadow: 0 3px 7px rgba(0,0,0,0.1); /* Sombra ligeramente más pronunciada */
}

/* Estado Focus (para accesibilidad con teclado) */
.btn:focus {
  outline: 2px solid var(--accent); /* Un outline con el color de acento */
  outline-offset: 2px; /* Separar el outline del borde del botón */
}

/* Estado Active (cuando se presiona) */
.btn:active {
  transform: translateY(0); /* Vuelve a la posición normal */
  box-shadow: 0 1px 2px rgba(0,0,0,0.06); /* Sombra más pequeña para dar efecto "presionado" */
  /* Opcional: background más oscuro o borde inset */
  /* background: darken(var(--button-hover), 5%); */
}

/* Estado Disabled */
.btn:disabled {
  opacity: 0.5; /* Reducir opacidad para indicar que está deshabilitado */
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}


/* Variantes */
/* Botón Primario (color de acento) */
.btn.primary {
  background: var(--accent);
  color: white; /* Texto blanco para contraste con el color de acento */
  border-color: var(--accent);
  box-shadow: 0 2px 4px rgba(0, 128, 0, 0.15); /* Sombra con un tinte del color de acento */
}
.btn.primary:hover {
  background: var(--accent-hover);
  border-color: var(--accent-hover);
  color: white;
  transform: translateY(-2px); /* Efecto de elevación un poco más pronunciado */
  box-shadow: 0 4px 8px rgba(0, 128, 0, 0.25); /* Sombra más grande y pronunciada */
}
.btn.primary:focus {
  outline: 2px solid white; /* Outline blanco para destacar sobre el color primario */
  outline-offset: 2px;
}
.btn.primary:active {
  transform: translateY(-1px); /* Pequeño "hundimiento" al presionar */
  box-shadow: 0 2px 3px rgba(0, 128, 0, 0.15); /* Sombra reducida */
}
.btn.primary:disabled {
 /* Mantener estilos disabled generales */
 box-shadow: none;
}


/* Botón Secundario (estilo por defecto, pero explícito) */
.btn.secondary {
  background: var(--button-bg);
  border-color: var(--button-border);
  color: var(--button-text);
  box-shadow: 0 1px 3px rgba(0,0,0,0.08); /* Sombra por defecto */
}
.btn.secondary:hover {
  background: var(--button-hover);
  border-color: var(--button-secondary-hover-border); /* Borde ligeramente más oscuro en hover */
  color: var(--button-text);
  transform: translateY(-1px);
  box-shadow: 0 3px 7px rgba(0,0,0,0.1);
}
.btn.secondary:focus {
  outline: 2px solid var(--accent); /* Usar color de acento para el outline de focus */
  outline-offset: 2px;
}
.btn.secondary:active {
  transform: translateY(0);
  box-shadow: 0 1px 2px rgba(0,0,0,0.06);
}
.btn.secondary:disabled {
 /* Mantener estilos disabled generales */
 box-shadow: none;
}

body, html {
  margin: 0;
  padding: 0;
  height: 100%;
  /* OCULTAR SCROLLBARS GLOBALES */
  overflow: hidden;
}

/* Estilo para el canvas de la nieve */
#snow-canvas {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 0; /* Asegura que el fondo esté detrás del contenido */
  pointer-events: none; /* Permite hacer clic a través del canvas */
}

body {
  font-family: var(--font-base);
  /* Aplicar el gradiente de fondo al body principal */
  background: linear-gradient(135deg, var(--bg-gradient-start), var(--bg-gradient-end));
  color: var(--text-primary);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--main-padding); /* Usar variable de padding */
  position: relative;
  /* overflow: hidden; /* Moved to html/body */
}

/* 5) Contenedor principal */
.main-container {
  position: relative;
  z-index: 1; /* sobre el canvas */
  background: var(--card-bg);
  backdrop-filter: blur(8px);
  border-radius: 12px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  padding: 2rem;
  max-width: 500px;
  width: 100%;
  text-align: center;

  /* --- Flexbox para layout Vertical sin scroll --- */
  display: flex;
  flex-direction: column; /* Apilar elementos verticalmente */
  height: 100%; /* Intentar ocupar toda la altura disponible */
  max-height: calc(100vh - (var(--main-padding) * 2)); /* Limitar a la altura del viewport menos el padding del body */
  /* Asegurar que el contenido interno no cause scroll en el main-container */
  overflow-y: hidden; /* Ocultar cualquier overflow vertical dentro del contenedor */
}

/* Los hijos directos de .main-container ahora son flex items */

/* 6) Encabezado */
header {
  flex-shrink: 0; /* Evitar que el header se encoja */
  margin-bottom: 1.5rem;
}
header h1 {
  font-family: var(--font-cinzel), var(--font-base);
  font-size: 1.8rem;
  font-weight: var(--font-weight-bold);
  margin-bottom: 0.5rem;
  color: var(--text-primary);
}
header p {
  font-size: 1rem;
  color: var(--text-secondary);
  margin-bottom: 0; /* Ajuste para layout flex */
}

/* 7) Área de carga (upload-box) y Vista previa (preview-area) */
/* Estos son siblings directos dentro de main-container, solo uno visible */
/* Deben poder expandirse para llenar el espacio o encogerse si es necesario */
.upload-box,
.preview-area {
  flex-grow: 1; /* Permitir que la sección visible crezca para ocupar el espacio restante */
  flex-shrink: 1; /* Permitir que se encoja si no hay suficiente espacio */
  /* Usar flexbox interno para alinear el contenido */
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center; /* Centrar contenido verticalmente si hay espacio extra */
  width: 100%; /* Asegurar que ocupan todo el ancho disponible */
  /* Añadir overflow hidden para que su contenido interno no cause scroll */
  overflow: hidden;
  /* margin-top: 1.5rem; /* Este margen se puede manejar con gap o margin-bottom en el header */
  margin-top: 0; /* Eliminar margen superior si el header tiene margin-bottom */
  margin-bottom: 1rem; /* Espacio entre esta sección y los mensajes/loading */
}


/* Estilos específicos para el área de carga */
.drop-area {
  background: rgba(255,255,255,0.5);
  border: 2px dashed var(--button-border);
  border-radius: 10px;
  padding: 2rem;
  transition: background 0.3s, border-color 0.3s;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  flex-grow: 1; /* Hacer que el drop-area ocupe el espacio dentro de upload-box */
  width: 100%; /* Asegurar que ocupa todo el ancho */
  /* Asegurar que el contenido interno no cause overflow */
  overflow: hidden;
}
.drop-area.dragover {
  background: rgba(255,255,255,0.8);
  border-color: var(--accent);
}
.drop-area i { margin-bottom: 0.5rem; }
.drop-area p { margin-bottom: 1rem; }
.drop-area small { font-size: 0.8rem; color: var(--text-secondary); }


.image-preview {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  /* --- Controlar la altura de la vista previa de la imagen --- */
  flex-grow: 1; /* Permite que esta área crezca para ocupar el espacio */
  flex-shrink: 1; /* Permite que se encoja si es necesario */
  overflow: hidden; /* Ocultar partes de la imagen si es demasiado grande para el espacio disponible */
  /* min-height: 100px; /* Puede ser útil tener una altura mínima, pero flex-grow 1 es mejor */
  margin-bottom: 1rem; /* Espacio debajo de la imagen */
  width: 100%; /* Asegurar que ocupa el ancho completo para centrar la imagen */
}

.preview-area img {
  /* La imagen se escalará dentro del contenedor image-preview flexible */
  max-width: 100%; /* Asegurar que la imagen no sea más ancha que su contenedor */
  max-height: 100%; /* Asegurar que la imagen no sea más alta que su contenedor flexible */
  height: auto; /* Mantener la relación de aspecto */
  width: auto; /* Mantener la relación de aspecto */
  object-fit: contain; /* Escalar la imagen para que quepa en el contenedor manteniendo su aspecto */
  border-radius: 8px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.1);
}

/* Info text */
.image-info {
  flex-shrink: 0; /* Evitar que se encoja */
  font-size: 0.9rem;
  color: var(--text-secondary);
  margin-bottom: 1rem;
}

/* Controls */
.controls {
  flex-shrink: 0; /* Evitar que los controles se encojan */
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 0.75rem;
  margin-top: 0; /* Ajuste para layout flex */
  margin-bottom: 0; /* Ajuste para layout flex */
}
.controls select,
.controls .btn {
   flex-shrink: 0; /* Evitar que los controles individuales se encojan */
}

/* Loading y Mensajes */
/* Estos también son hijos directos de main-container */
.loading,
.message {
   flex-shrink: 0; /* Evitar que se encojan */
   margin-top: auto; /* Empujar los mensajes al final si hay espacio */
   /* Añadir un margen superior explícito si el margin-top: auto es inconsistente */
   /* margin-top: 1rem; */
   /* ... otros estilos */
}


/* 11) Responsive */
@media (max-width: 600px) {
  .main-container {
      padding: 1.5rem;
      /* Ajustar el cálculo de la altura máxima para el nuevo padding */
      max-height: calc(100vh - (1.5rem * 2));
  }
  header h1 { font-size: 1.5rem; }
  .drop-area { padding: 1.5rem; }

  /* Controls stack vertically on mobile */
  .controls {
      flex-direction: column;
      gap: 0.5rem;
  }
   .controls .btn,
    .controls select {
        width: 100%; /* Full width on mobile */
        margin-left: 0;
        margin-right: 0;
        flex-shrink: 0;
   }
}